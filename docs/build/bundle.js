var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function s(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function l(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function i(t,e,n,r,s,o,c){const i=function(t,e,n,r){if(t[2]&&r){const s=t[2](r(n));if(void 0===e.dirty)return s;if("object"==typeof s){const t=[],n=Math.max(e.dirty.length,s.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|s[r];return t}return e.dirty|s}return e.dirty}(e,r,s,o);if(i){const s=l(e,n,r,c);t.p(s,i)}}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function p(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function $(){return d(" ")}function h(){return d("")}function m(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let y;function b(t){y=t}const x=[],w=[],_=[],k=[],j=Promise.resolve();let O=!1;function L(t){_.push(t)}let q=!1;const E=new Set;function N(){if(!q){q=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];b(e),P(e.$$)}for(b(null),x.length=0;w.length;)w.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];E.has(e)||(E.add(e),e())}_.length=0}while(x.length);for(;k.length;)k.pop()();O=!1,q=!1,E.clear()}}function P(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}const T=new Set;let S;function A(){S={r:0,c:[],p:S}}function C(){S.r||r(S.c),S=S.p}function R(t,e){t&&t.i&&(T.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(T.has(t))return;T.add(t),S.c.push((()=>{T.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function U(t){t&&t.c()}function B(t,n,o,c){const{fragment:l,on_mount:i,on_destroy:a,after_update:u}=t.$$;l&&l.m(n,o),c||L((()=>{const n=i.map(e).filter(s);a?a.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(L)}function M(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function I(t,e){-1===t.$$.dirty[0]&&(x.push(t),O||(O=!0,j.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(e,s,o,c,l,i,a=[-1]){const u=y;b(e);const p=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:a,skip_bound:!1};let d=!1;if(p.ctx=o?o(e,s.props||{},((t,n,...r)=>{const s=r.length?r[0]:n;return p.ctx&&l(p.ctx[t],p.ctx[t]=s)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](s),d&&I(e,t)),n})):[],p.update(),d=!0,r(p.before_update),p.fragment=!!c&&c(p.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);p.fragment&&p.fragment.l(t),t.forEach(f)}else p.fragment&&p.fragment.c();s.intro&&R(e.$$.fragment),B(e,s.target,s.anchor,s.customElement),N()}b(u)}class F{$destroy(){M(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const H=[];function J(e,n=t){let r;const s=[];function c(t){if(o(e,t)&&(e=t,r)){const t=!H.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),H.push(n,e)}if(t){for(let t=0;t<H.length;t+=2)H[t][0](H[t+1]);H.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(o,l=t){const i=[o,l];return s.push(i),1===s.length&&(r=n(c)||t),o(e),()=>{const t=s.indexOf(i);-1!==t&&s.splice(t,1),0===s.length&&(r(),r=null)}}}}const{API_URL:G}={API_URL:"http://local.api.mbs3.fightthe.pw:8055",UI_URL:"http://local.mbs3.fightthe.pw:5000",isProd:!0},K=J(null),Q=J(null),V=J(null),W=()=>{const{hash:t}=location;"#/players"==t?V.set("players"):(V.set("home"),"#/"!=t&&(location.hash="#/"))};window.addEventListener("hashchange",W),W();const X=(t,e={headers:{}})=>fetch(`${G}${t}`,Object.assign(Object.assign({},e),{headers:Object.assign({Authorization:Y?`Bearer ${Y}`:void 0},e.headers)})).then((t=>t.json()));let Y;function Z(t){let e,n,r,s,o,c,l,i,$=t[0].username+"";return{c(){e=p("div"),n=d("Logged in as\n    "),r=p("b"),s=d($),o=d(" -\n    "),c=p("a"),c.textContent="Log out",g(c,"href","#/"),g(e,"class","me svelte-jxqpbw")},m(f,p){u(f,e,p),a(e,n),a(e,r),a(r,s),a(e,o),a(e,c),l||(i=m(c,"click",t[1]),l=!0)},p(t,e){1&e&&$!==($=t[0].username+"")&&v(s,$)},d(t){t&&f(e),l=!1,i()}}}function tt(e){let n,r,s,o=e[0]&&Z(e);return{c(){n=p("div"),r=p("a"),r.innerHTML='<div class="logo svelte-jxqpbw"><img alt="" src="/images/logo.png" class="svelte-jxqpbw"/></div> \n    <h1 class="svelte-jxqpbw"><img alt="Mania Beginner&#39;s Showdown" src="/images/title.png" class="svelte-jxqpbw"/> \n      <div class="three svelte-jxqpbw"><span class="svelte-jxqpbw">3</span></div></h1>',s=$(),o&&o.c(),g(r,"href","#/"),g(n,"class","banner svelte-jxqpbw")},m(t,e){u(t,n,e),a(n,r),a(n,s),o&&o.m(n,null)},p(t,[e]){t[0]?o?o.p(t,e):(o=Z(t),o.c(),o.m(n,null)):o&&(o.d(1),o=null)},i:t,o:t,d(t){t&&f(n),o&&o.d()}}}function et(t,e,n){let r;c(t,K,(t=>n(0,r=t)));var s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(s,o){function c(t){try{i(r.next(t))}catch(t){o(t)}}function l(t){try{i(r.throw(t))}catch(t){o(t)}}function i(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}i((r=r.apply(t,e||[])).next())}))};return[r,()=>s(void 0,void 0,void 0,(function*(){yield X("/auth/logout",{method:"POST"}),location.reload()}))]}(async()=>{const{data:t}=await X("/items/players?fields=id,username,country,avatar,timezone,ranking,pp&sort=ranking");Q.set(t);const e=await fetch(`${G}/auth/refresh`,{method:"POST",credentials:"include"});if(200==e.status){const n=await e.json();Y=n.data.access_token;const{data:{first_name:r,email:s,avatar:o}}=await X("/users/me?fields=first_name,email"),c=t.find((({id:t})=>s==t));K.set({avatar:o,username:r,id:s,player:c}),c||(location.hash="#/players")}})();class nt extends F{constructor(t){super(),D(this,t,et,tt,o,{})}}function rt(t){let e,n,r,s,o,c;const d=t[3].default,$=function(t,e,n,r){if(t){const s=l(t,e,n,r);return t[0](s)}}(d,t,t[2],null);return{c(){e=p("a"),n=p("div"),$&&$.c(),g(n,"class","text svelte-1nr1k0b"),g(e,"href",t[0]),g(e,"target",t[1]),g(e,"rel",r="_blank"===t[1]?"noopener":void 0),g(e,"class","button svelte-1nr1k0b")},m(r,l){u(r,e,l),a(e,n),$&&$.m(n,null),s=!0,o||(c=m(e,"click",t[4]),o=!0)},p(t,[n]){$&&$.p&&4&n&&i($,d,t,t[2],n,null,null),(!s||1&n)&&g(e,"href",t[0]),(!s||2&n)&&g(e,"target",t[1]),(!s||2&n&&r!==(r="_blank"===t[1]?"noopener":void 0))&&g(e,"rel",r)},i(t){s||(R($,t),s=!0)},o(t){z($,t),s=!1},d(t){t&&f(e),$&&$.d(t),o=!1,c()}}}function st(t,e,n){let{$$slots:r={},$$scope:s}=e,{href:o}=e,{target:c=""}=e;return t.$$set=t=>{"href"in t&&n(0,o=t.href),"target"in t&&n(1,c=t.target),"$$scope"in t&&n(2,s=t.$$scope)},[o,c,s,r,function(e){!function(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t(e)))}(t,e)}]}class ot extends F{constructor(t){super(),D(this,t,st,rt,o,{href:0,target:1})}}function ct(e){let n,r,s,o,c,l,i,h,m,y,b,x,w,_,k,j,O,L,q,E=e[0].username+"",N=e[0].country+"",P=e[0].ranking+"",T=Number(e[0].pp).toFixed(2)+"";return{c(){n=p("a"),r=p("div"),s=p("img"),c=$(),l=p("div"),i=d(E),h=$(),m=p("div"),y=d(N),b=$(),x=p("div"),w=d(P),_=$(),k=p("div"),j=d("("),O=d(T),L=d(" pp)"),g(s,"class","avatar svelte-sv5y11"),s.src!==(o=e[0].avatar)&&g(s,"src",o),g(s,"alt",""),g(r,"class","avatar svelte-sv5y11"),g(m,"class","country svelte-sv5y11"),g(l,"class","name svelte-sv5y11"),g(k,"class","pp svelte-sv5y11"),g(x,"class","ranking svelte-sv5y11"),g(n,"class","player svelte-sv5y11"),g(n,"href",q=`https://osu.ppy.sh/users/${e[0].id}`),g(n,"target","_blank"),g(n,"rel","noopener")},m(t,e){u(t,n,e),a(n,r),a(r,s),a(n,c),a(n,l),a(l,i),a(l,h),a(l,m),a(m,y),a(n,b),a(n,x),a(x,w),a(x,_),a(x,k),a(k,j),a(k,O),a(k,L)},p(t,[e]){1&e&&s.src!==(o=t[0].avatar)&&g(s,"src",o),1&e&&E!==(E=t[0].username+"")&&v(i,E),1&e&&N!==(N=t[0].country+"")&&v(y,N),1&e&&P!==(P=t[0].ranking+"")&&v(w,P),1&e&&T!==(T=Number(t[0].pp).toFixed(2)+"")&&v(O,T),1&e&&q!==(q=`https://osu.ppy.sh/users/${t[0].id}`)&&g(n,"href",q)},i:t,o:t,d(t){t&&f(n)}}}function lt(t,e,n){let{player:r}=e;return t.$$set=t=>{"player"in t&&n(0,r=t.player)},[r]}class it extends F{constructor(t){super(),D(this,t,lt,ct,o,{player:0})}}function at(t,e,n){const r=t.slice();return r[4]=e[n],r}function ut(e){let n;return{c(){n=p("p"),n.textContent="List of players",g(n,"class","registration svelte-9p98v4")},m(t,e){u(t,n,e)},p:t,i:t,o:t,d(t){t&&f(n)}}}function ft(t){let e,n,r,s;const o=[$t,dt],c=[];function l(t,e){return t[0]?0:1}return n=l(t),r=c[n]=o[n](t),{c(){e=p("p"),r.c(),g(e,"class","confirm svelte-9p98v4")},m(t,r){u(t,e,r),c[n].m(e,null),s=!0},p(t,s){let i=n;n=l(t),n===i?c[n].p(t,s):(A(),z(c[i],1,1,(()=>{c[i]=null})),C(),r=c[n],r?r.p(t,s):(r=c[n]=o[n](t),r.c()),R(r,1),r.m(e,null))},i(t){s||(R(r),s=!0)},o(t){z(r),s=!1},d(t){t&&f(e),c[n].d()}}}function pt(t){let e,n,r;return n=new ot({props:{href:"http://local.api.mbs3.fightthe.pw:8055/auth/oauth/osu?redirect=http://local.mbs3.fightthe.pw:5000",$$slots:{default:[mt]},$$scope:{ctx:t}}}),{c(){e=p("p"),U(n.$$.fragment),g(e,"class","register svelte-9p98v4")},m(t,s){u(t,e,s),B(n,e,null),r=!0},p(t,e){const r={};128&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){r||(R(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(t){t&&f(e),M(n)}}}function dt(t){let e,n;return e=new ot({props:{href:"javascript:void(0)",$$slots:{default:[ht]},$$scope:{ctx:t}}}),e.$on("click",t[3]),{c(){U(e.$$.fragment)},m(t,r){B(e,t,r),n=!0},p(t,n){const r={};128&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function $t(e){let n;return{c(){n=d("Registering...")},m(t,e){u(t,n,e)},p:t,i:t,o:t,d(t){t&&f(n)}}}function ht(t){let e;return{c(){e=d("Confirm registration")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function mt(t){let e;return{c(){e=d("Register")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function gt(t){let e,n,r=t[2],s=[];for(let e=0;e<r.length;e+=1)s[e]=yt(at(t,r,e));const o=t=>z(s[t],1,1,(()=>{s[t]=null}));return{c(){e=p("p");for(let t=0;t<s.length;t+=1)s[t].c();g(e,"class","players svelte-9p98v4")},m(t,r){u(t,e,r);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,n){if(4&n){let c;for(r=t[2],c=0;c<r.length;c+=1){const o=at(t,r,c);s[c]?(s[c].p(o,n),R(s[c],1)):(s[c]=yt(o),s[c].c(),R(s[c],1),s[c].m(e,null))}for(A(),c=r.length;c<s.length;c+=1)o(c);C()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)R(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)z(s[t]);n=!1},d(t){t&&f(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(s,t)}}}function vt(e){let n;return{c(){n=d("Loading players...")},m(t,e){u(t,n,e)},p:t,i:t,o:t,d(t){t&&f(n)}}}function yt(t){let e,n;return e=new it({props:{player:t[4]}}),{c(){U(e.$$.fragment)},m(t,r){B(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.player=t[4]),e.$set(r)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function bt(t){let e,n,r,s,o,c,l;const i=[pt,ft,ut],a=[];function p(t,e){return t[1]?t[1].player?2:1:0}e=p(t),n=a[e]=i[e](t);const d=[vt,gt],m=[];function g(t,e){return t[2]?1:0}return s=g(t),o=m[s]=d[s](t),{c(){n.c(),r=$(),o.c(),c=h()},m(t,n){a[e].m(t,n),u(t,r,n),m[s].m(t,n),u(t,c,n),l=!0},p(t,[l]){let u=e;e=p(t),e===u?a[e].p(t,l):(A(),z(a[u],1,1,(()=>{a[u]=null})),C(),n=a[e],n?n.p(t,l):(n=a[e]=i[e](t),n.c()),R(n,1),n.m(r.parentNode,r));let f=s;s=g(t),s===f?m[s].p(t,l):(A(),z(m[f],1,1,(()=>{m[f]=null})),C(),o=m[s],o?o.p(t,l):(o=m[s]=d[s](t),o.c()),R(o,1),o.m(c.parentNode,c))},i(t){l||(R(n),R(o),l=!0)},o(t){z(n),z(o),l=!1},d(t){a[e].d(t),t&&f(r),m[s].d(t),t&&f(c)}}}function xt(t,e,n){let r,s;c(t,K,(t=>n(1,r=t))),c(t,Q,(t=>n(2,s=t)));let o=!1;return[o,r,s,async()=>{n(0,o=!0);const t=-(new Date).getTimezoneOffset()/60,e=await X("/items/players",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r.id,timezone:`UTC${t>0?"+":""}${t}`})});e.errors?alert(e.errors[0].message):(K.set({...r,player:e.data}),Q.set(s.concat([e]).sort(((t,e)=>e.ranking-t.ranking)))),n(0,o=!1)}]}class wt extends F{constructor(t){super(),D(this,t,xt,bt,o,{})}}function _t(t){let e;return{c(){e=d("Register here!")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function kt(t){let e;return{c(){e=d("Discord")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function jt(t){let e;return{c(){e=d("Players")},m(t,n){u(t,e,n)},d(t){t&&f(e)}}}function Ot(t){let e,n,r,s,o,c,l,i,d;return s=new ot({props:{href:t[0],$$slots:{default:[_t]},$$scope:{ctx:t}}}),c=new ot({props:{href:"https://discord.gg/uNSqksR",target:"_blank",$$slots:{default:[kt]},$$scope:{ctx:t}}}),i=new ot({props:{href:"#/players",$$slots:{default:[jt]},$$scope:{ctx:t}}}),{c(){e=p("main"),n=p("div"),r=p("div"),U(s.$$.fragment),o=$(),U(c.$$.fragment),l=$(),U(i.$$.fragment),g(r,"class","register svelte-jkzlu5"),g(n,"class","links svelte-jkzlu5")},m(t,f){u(t,e,f),a(e,n),a(n,r),B(s,r,null),a(n,o),B(c,n,null),a(n,l),B(i,n,null),d=!0},p(t,[e]){const n={};1&e&&(n.href=t[0]),4&e&&(n.$$scope={dirty:e,ctx:t}),s.$set(n);const r={};4&e&&(r.$$scope={dirty:e,ctx:t}),c.$set(r);const o={};4&e&&(o.$$scope={dirty:e,ctx:t}),i.$set(o)},i(t){d||(R(s.$$.fragment,t),R(c.$$.fragment,t),R(i.$$.fragment,t),d=!0)},o(t){z(s.$$.fragment,t),z(c.$$.fragment,t),z(i.$$.fragment,t),d=!1},d(t){t&&f(e),M(s),M(c),M(i)}}}function Lt(t,e,n){let r,s;return c(t,K,(t=>n(1,s=t))),t.$$.update=()=>{2&t.$$.dirty&&n(0,r=s?"#/players":"http://local.api.mbs3.fightthe.pw:8055/auth/oauth/osu?redirect=http://local.mbs3.fightthe.pw:5000")},[r,s]}class qt extends F{constructor(t){super(),D(this,t,Lt,Ot,o,{})}}function Et(t){let e,n;return e=new qt({}),{c(){U(e.$$.fragment)},m(t,r){B(e,t,r),n=!0},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Nt(t){let e,n;return e=new wt({}),{c(){U(e.$$.fragment)},m(t,r){B(e,t,r),n=!0},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Pt(t){let e,n,r,s,o,c;e=new nt({});const l=[Nt,Et],i=[];function a(t,e){return"players"==t[0]?0:1}return r=a(t),s=i[r]=l[r](t),{c(){U(e.$$.fragment),n=$(),s.c(),o=h()},m(t,s){B(e,t,s),u(t,n,s),i[r].m(t,s),u(t,o,s),c=!0},p(t,[e]){let n=r;r=a(t),r!==n&&(A(),z(i[n],1,1,(()=>{i[n]=null})),C(),s=i[r],s||(s=i[r]=l[r](t),s.c()),R(s,1),s.m(o.parentNode,o))},i(t){c||(R(e.$$.fragment,t),R(s),c=!0)},o(t){z(e.$$.fragment,t),z(s),c=!1},d(t){M(e,t),t&&f(n),i[r].d(t),t&&f(o)}}}function Tt(t,e,n){let r;return c(t,V,(t=>n(0,r=t))),[r]}return new class extends F{constructor(t){super(),D(this,t,Tt,Pt,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
